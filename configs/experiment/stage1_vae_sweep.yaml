# @package _global_

defaults:
  - override /data: sc_atlas_ae
  - override /model: ae_stage1_vae
  - override /trainer: default

task_name: "vae_kl_sweep_1216"

tags: ["vae", "kl_sweep", "beta_vae", "1216"]

seed: 12345

trainer:
  min_epochs: 1
  max_epochs: 10
  gradient_clip_val: 0.5

model:
  optimizer:
    lr: 1e-4

logger:
  wandb:
    group: "vae_kl_sweep"
    name: "vae_kld${model.kld_weight}_latent${model.net.latent_dim}_${hydra:job.num}"

hydra:
  mode: MULTIRUN
  sweeper:
    params:
      # Sweep 1: 不同的 KL 权重（最重要）
      model.kld_weight: 1e-6,1e-5,1e-4,1e-3
      
      # Sweep 2: 不同的潜在空间维度
      model.net.latent_dim: 32,64,128,256
      
      # Sweep 3（可选）: 不同的激活函数
      # model.net.activation: GELU,SiLU,LeakyReLU

